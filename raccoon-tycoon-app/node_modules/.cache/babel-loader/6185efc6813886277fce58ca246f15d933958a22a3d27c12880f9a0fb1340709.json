{"ast":null,"code":"import _toConsumableArray from\"C:/Users/steph/OneDrive/Documents/GitHub/personal/tca-raccoon-tycoon/raccoon-tycoon-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Users/steph/OneDrive/Documents/GitHub/personal/tca-raccoon-tycoon/raccoon-tycoon-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/steph/OneDrive/Documents/GitHub/personal/tca-raccoon-tycoon/raccoon-tycoon-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/steph/OneDrive/Documents/GitHub/personal/tca-raccoon-tycoon/raccoon-tycoon-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./App.css';import'bootstrap/dist/css/bootstrap.min.css';import{Home}from'./Home';import{Setup}from'./Setup';import{Finish}from'./Finish';import logo from'./hat.png';import{calculateLeaderboard,getPreviousPlayers}from'./front-end-model';import{HashRouter,Routes,Route}from'react-router-dom';import{useState,useEffect}from'react';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import localforage from'localforage';import{saveGameToCloud,loadGamesFromCloud}from'./tca-cloud-api';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){//State hooks\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),results=_useState2[0],setGameResults=_useState2[1];var _useState3=useState({start:\" \",chosenPlayers:[]}),_useState4=_slicedToArray(_useState3,2),setupInfo=_useState4[0],setSetupInfo=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),emailKeyInput=_useState6[0],setEmailKeyInput=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),emailKeySaved=_useState8[0],setEmailKeySaved=_useState8[1];//useEffect hook\nuseEffect(function(){var loadEmailKeyAndGameResults=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _String,ek,resultsFromCloud;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.t1=String;_context.next=4;return localforage.getItem(\"emailKey\");case 4:_context.t2=_context.sent;_context.t3=_String=(0,_context.t1)(_context.t2);_context.t0=_context.t3!==null;if(!_context.t0){_context.next=9;break;}_context.t0=_String!==void 0;case 9:if(!_context.t0){_context.next=13;break;}_context.t4=_String;_context.next=14;break;case 13:_context.t4=\"\";case 14:ek=_context.t4;if(!(ek.length>0)){_context.next=19;break;}_context.next=18;return loadGamesFromCloud(ek,\"tca-raccoon-tycoon\");case 18:resultsFromCloud=_context.sent;case 19:if(!ignore){setEmailKeyInput(ek);setEmailKeySaved(ek);}_context.next=25;break;case 22:_context.prev=22;_context.t5=_context[\"catch\"](0);console.error(_context.t5);case 25:case\"end\":return _context.stop();}},_callee,null,[[0,22]]);}));return function loadEmailKeyAndGameResults(){return _ref.apply(this,arguments);};}();var ignore=false;loadEmailKeyAndGameResults();return function(){ignore=true;};},[]);//Helper functions\nvar addGameResult=function addGameResult(r){//Save game result to cloud.\nsaveGameToCloud(emailKeySaved,\"tca-raccoon-tycoon\",r.end,r);//Optimistically update the lifted app state.\nsetGameResults([].concat(_toConsumableArray(results),[r]));};var saveEmailKey=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return localforage.setItem(\"emailKey\",emailKeyInput);case 3:setEmailKeySaved(emailKeyInput);_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 9:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function saveEmailKey(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"App m-3\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"logo\",className:\"hat w-50\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"TCA Raccoon Tycoon\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Companion App\"}),/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Main Player Email:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Main player email\",value:emailKeyInput,onChange:function onChange(e){return setEmailKeyInput(e.target.value);},className:\"mb-3\"}),/*#__PURE__*/_jsx(Button,{onClick:saveEmailKey,children:\"Save\"})]})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(HashRouter,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{leaderboardData:calculateLeaderboard(results)})}),/*#__PURE__*/_jsx(Route,{path:\"/setup\",element:/*#__PURE__*/_jsx(Setup,{previousPlayers:getPreviousPlayers(results),setSetupInfo:setSetupInfo})}),/*#__PURE__*/_jsx(Route,{path:\"/finish\",element:/*#__PURE__*/_jsx(Finish,{addGameResultFunc:addGameResult,setupInfo:setupInfo})})]})})]});};export default App;","map":{"version":3,"names":["Home","Setup","Finish","logo","calculateLeaderboard","getPreviousPlayers","HashRouter","Routes","Route","useState","useEffect","Form","Button","localforage","saveGameToCloud","loadGamesFromCloud","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","results","setGameResults","_useState3","start","chosenPlayers","_useState4","setupInfo","setSetupInfo","_useState5","_useState6","emailKeyInput","setEmailKeyInput","_useState7","_useState8","emailKeySaved","setEmailKeySaved","loadEmailKeyAndGameResults","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_String","ek","resultsFromCloud","wrap","_callee$","_context","prev","next","t1","String","getItem","t2","sent","t3","t0","t4","length","ignore","t5","console","error","stop","apply","arguments","addGameResult","r","end","concat","_toConsumableArray","saveEmailKey","_ref2","_callee2","_callee2$","_context2","setItem","className","children","src","alt","Group","Label","Control","type","placeholder","value","onChange","e","target","onClick","path","element","leaderboardData","previousPlayers","addGameResultFunc"],"sources":["C:/Users/steph/OneDrive/Documents/GitHub/personal/tca-raccoon-tycoon/raccoon-tycoon-app/src/App.tsx"],"sourcesContent":["import './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport { Home } from './Home';\nimport { Setup } from './Setup';\nimport { Finish } from './Finish';\nimport logo from './hat.png';\n\nimport { \n  GameResult\n  , CalculateLeaderboardFunc\n  , calculateLeaderboard\n  , getPreviousPlayers\n  , SetupInfo \n} from './front-end-model';\n\nimport { \n  HashRouter\n  , Routes\n  , Route \n} from 'react-router-dom';\n\nimport { useState, useEffect } from 'react';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport localforage from 'localforage';\n\nimport { saveGameToCloud, loadGamesFromCloud } from './tca-cloud-api';\n\n\nconst App = () => {\n\n  //State hooks\n  const [results, setGameResults] = useState<GameResult[]>([]);\n\n  const [setupInfo, setSetupInfo] = useState<SetupInfo>({\n    start: \" \"\n    , chosenPlayers: []\n  });\n\n  const [emailKeyInput, setEmailKeyInput] = useState(\"\");\n  const [emailKeySaved, setEmailKeySaved] = useState(\"\");\n\n  //useEffect hook\n  useEffect(\n    () => {\n\n      const loadEmailKeyAndGameResults = async () => {\n      \n        try {\n\n          const ek = String(await localforage.getItem(\"emailKey\")) ?? \"\";\n\n          if (ek.length > 0) {\n\n            const resultsFromCloud = await loadGamesFromCloud(\n              ek\n              , \"tca-raccoon-tycoon\"\n            );\n            \n          }\n\n          if(!ignore) {\n          setEmailKeyInput(ek);\n          setEmailKeySaved(ek);\n          }\n        }\n        catch (err) {\n          console.error(err);\n        }\n      };\n \n      let ignore = false;\n      loadEmailKeyAndGameResults();\n      return () => {\n        ignore = true;\n      };\n    }\n    , []\n  );\n\n\n  //Helper functions\n  const addGameResult = (r: GameResult) => {\n\n    //Save game result to cloud.\n    saveGameToCloud(\n      emailKeySaved\n      , \"tca-raccoon-tycoon\"\n      , r.end\n      , r\n    );\n\n    //Optimistically update the lifted app state.\n    setGameResults([\n      ...results \n      , r\n    ]);\n  };\n\n  const saveEmailKey = async () => {\n    try {\n      await localforage.setItem(\n        \"emailKey\"\n        , emailKeyInput\n      );\n\n      setEmailKeySaved(emailKeyInput);\n    }\n    catch (err) {\n      console.error(err);\n    }\n  };\n\n\n\n  return (\n    <div className=\"App m-3\">\n      <img src={logo} alt=\"logo\" className=\"hat w-50\" />\n      <h1>\n        TCA Raccoon Tycoon\n      </h1>\n      <h2>\n        Companion App\n      </h2>\n      <form>\n      <Form.Group className=\"mb-3\">\n        <Form.Label>Main Player Email:</Form.Label>\n          <Form.Control \n            type=\"text\"\n            placeholder=\"Main player email\"\n            value={emailKeyInput}\n            onChange={(e) => setEmailKeyInput(e.target.value)} \n            className=\"mb-3\"\n          />\n            <Button\n              onClick={saveEmailKey}\n            >\n              Save\n            </Button>\n      </Form.Group>\n      </form>  \n      <hr />\n      <HashRouter>\n        <Routes>\n          <Route \n            path=\"/\" \n            element={\n              <Home\n                leaderboardData={calculateLeaderboard(results)}\n              />\n            } \n          />\n          <Route \n            path=\"/setup\" \n            element={\n              <Setup\n                previousPlayers={getPreviousPlayers(results)}\n                setSetupInfo={setSetupInfo}     \n              />\n            } \n          />\n          <Route \n            path=\"/finish\" \n            element={\n              <Finish\n              addGameResultFunc={addGameResult}\n              setupInfo={setupInfo} \n              />\n            } \n          />\n        </Routes>\n      </HashRouter>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}